# Requirements Document

## Introduction

本ドキュメントは、プロジェクト管理サービスにおける「親しみ感のある落ち着いた明るい色合いのチケットリスト」を実現するための要件定義書である。ユーザーの生産性と可読性、アクセシビリティを重視しつつ、操作性・パフォーマンス・権限管理・共有性までを一貫して設計する。

## Requirments

#### Epic 1
チケットリストのビジュアルテーマと言語化されたデザイン原則（落ち着いた明るい色合い、親しみやすさ、可読性）を確立し、プロダクト全体で一貫適用する。

##### Requirment 1
**User Story:** プロジェクトメンバーとして、落ち着いた明るい色合いのテーマを選びたい。長時間の作業でも疲れにくく気持ちよく使えるから。

###### Acceptance Criteria
1. 常に、既定テーマは淡いトーン（彩度中低、明度中高）のカラーパレットを適用しなければならない。
2. 利用者がテーマ設定画面を開いた場合、既定テーマと高コントラスト亜種の少なくとも2種から選択できなければならない。
3. テーマが変更されたとき、画面全体の背景・テキスト・ボーダー・バッジ色が即時に反映されなければならない。
4. 読みにくい配色が選択された場合、システムはコントラストを自動補正しなければならない。

##### Requirment 2
**User Story:** デザイナーとして、色やスペーシングをデザイントークンで管理したい。全画面で一貫性を保つため。

###### Acceptance Criteria
1. 常に、色・余白・タイポグラフィはトークン（例：`color.surface.100`）経由で参照しなければならない。
2. 新規画面が追加された場合、トークン以外の生色値の直書きは許されてはならない。
3. トークン値を更新したとき、該当する全てのUIに即時反映されなければならない。

##### Requirment 3
**User Story:** 色覚多様性のあるユーザーとして、意味が色だけに依存しない表示がほしい。情報を取りこぼさないため。

###### Acceptance Criteria
1. 状態や優先度の識別には、色に加えてアイコンやラベルを常に併用しなければならない。
2. 色だけで判別する要素がある場合、システムは警告を表示し修正提案を示さなければならない。
3. 状態バッジは色相が近い場合でも模様/アイコン差異で区別できなければならない。

##### Requirment 4
**User Story:** プロジェクトマネージャーとして、空状態やエンプティステートでも前向きなトーンで導線を見たい。初回利用時の不安を減らしたいから。

###### Acceptance Criteria
1. リストが空の場合、穏やかなイラストと「チケットを作成」CTAが表示されなければならない。
2. 検索で結果が0件の場合、検索条件の見直しチップを提示しなければならない。
3. どの空状態でも説明テキストは2行以内で簡潔でなければならない。

---

#### Epic 2
チケット一覧の表示要素と列管理（表示項目・並び順・幅・固定・保存）を整備する。

##### Requirment 5
**User Story:** メンバーとして、必要な列だけを表示したい。自分の作業に集中するため。

###### Acceptance Criteria
1. 列設定ダイアログを開いたとき、表示可能列の一覧とチェックボックスが表示されなければならない。
2. 列の表示/非表示を変更した場合、その設定はユーザー単位で自動保存されなければならない。
3. 非表示にした列のデータはエクスポート時に選択できる説明が提示されなければならない。

##### Requirment 6
**User Story:** メンバーとして、列順や幅を調整して保存したい。読みやすくするため。

###### Acceptance Criteria
1. 列ヘッダをドラッグした場合、列順を変更できなければならない。
2. 列境界のドラッグで幅を変更したとき、次回アクセス時も反映されなければならない。
3. 重要列（タイトル、ステータス）は左固定を設定できなければならない。

##### Requirment 7
**User Story:** リードとして、一覧に最低限の共通列（タイトル/ステータス/担当/期限/優先度/更新日）を揃えたい。チームの認識合わせのため。

###### Acceptance Criteria
1. 初期表示では共通列6種が既定で表示されなければならない。
2. 共通列は必ず選択候補に存在しなければならない。
3. 共通列のヘッダには説明ツールチップが提供されなければならない。

##### Requirment 8
**User Story:** メンバーとして、一覧の件数と選択中の表示条件の要約を見たい。状態を一目で把握するため。

###### Acceptance Criteria
1. 常に、リスト上部に「総件数/表示件数」と適用中のフィルタ要約を表示しなければならない。
2. 要約の各条件をクリックした場合、その条件を編集できなければならない。
3. 件数バッジはページネーションと整合していなければならない。

---

#### Epic 3
フィルタリング・検索・ソート・保存ビューを提供し、探す/絞る体験を最適化する。

##### Requirment 9
**User Story:** メンバーとして、よく使うクイックフィルタ（自分の担当・期限今週・期限超過）をワンタップで使いたい。時間短縮のため。

###### Acceptance Criteria
1. 常に、ヘッダ直下にクイックフィルタ3種が表示されていなければならない。
2. 期限超過のクイックフィルタを適用した場合、赤系バッジと説明が表示されなければならない。
3. 複数クイックフィルタは同時適用できなければならない。

##### Requirment 10
**User Story:** アナリストとして、複合条件（AND/OR、範囲、否定）で高度に絞り込みたい。正確に対象を抽出するため。

###### Acceptance Criteria
1. フィルタビルダーで「フィールド/演算子/値」を組み合わせられなければならない。
2. 条件はAND/ORでグルーピングできなければならない。
3. 無効な条件式が入力された場合、保存はできてはならない。
4. 日付範囲の指定では開始>終了のときエラーを表示しなければならない。

##### Requirment 11
**User Story:** PMとして、検索とソート設定を「保存ビュー」として保存・共有したい。チームで共通の見方を持つため。

###### Acceptance Criteria
1. 現在の検索・フィルタ・ソート・列設定を1クリックで保存できなければならない。
2. ビュー保存時に「個人/ワークスペース共有」を選択できなければならない。
3. 共有ビューはURLで参照可能で、権限外のユーザーには表示されてはならない。
4. ビューを更新した場合、既存URLは変化してはならない。

##### Requirment 12
**User Story:** メンバーとして、キーワード検索でタイトル・説明・コメントを横断検索したい。目的のチケットを即座に見つけるため。

###### Acceptance Criteria
1. 検索ボックスに文字を入力したとき、0.3秒以内にサジェストが表示されなければならない。
2. 検索は全角/半角・大小文字を区別せず動作しなければならない。
3. 検索失敗時でもリストは破壊的にリセットされてはならない。

---

#### Epic 4
リスト上での編集・作成・一括操作を実現し、移動コストを最小化する。

##### Requirment 13
**User Story:** メンバーとして、タイトルやステータス・担当・期限をインライン編集したい。ページ遷移なく手早く更新するため。

###### Acceptance Criteria
1. セルをダブルクリックした場合、インライン編集モードに入らなければならない。
2. 編集確定後、0.7秒以内に更新結果が表示されなければならない。
3. 権限がない項目は編集UIを表示してはならない。
4. 競合が発生した場合、マージ提案と再試行が提示されなければならない。

##### Requirment 14
**User Story:** PMとして、複数チケットを選択してステータス変更・担当アサイン・タグ付けを一括で行いたい。運用コストを下げるため。

###### Acceptance Criteria
1. 行チェックボックスで複数選択した場合、ツールバーに一括操作が表示されなければならない。
2. 一括操作は変更対象の件数と影響項目を確認ダイアログで提示しなければならない。
3. 実行後、成功/失敗件数のサマリーを表示し、失敗行を再試行できなければならない。

##### Requirment 15
**User Story:** メンバーとして、リストから新規チケットをすぐ作成したい。作業の流れを止めないため。

###### Acceptance Criteria
1. 「新規チケット」ボタンを押下した場合、モーダルで最小必須項目（タイトル/プロジェクト/ステータス）が入力できなければならない。
2. 保存後、作成した行が先頭に挿入されハイライトされなければならない。
3. 入力が不足している場合、保存はできてはならない。

##### Requirment 16
**User Story:** メンテナとして、不要チケットを削除またはアーカイブしたい。リストを健全に保つため。

###### Acceptance Criteria
1. 削除を選択した場合、確認ダイアログで不可逆性を明示しなければならない。
2. アーカイブは復元可能であり、一覧からは非表示にならなければならない。
3. 権限が不足している場合、削除・アーカイブ操作は表示されてはならない。

---

#### Epic 5
パフォーマンス・スケーラビリティ・ローディング体験を最適化する。

##### Requirment 17
**User Story:** メンバーとして、100件程度の一覧は体感待ち時間なく見たい。集中を切らしたくないから。

###### Acceptance Criteria
1. 初回100件の表示はネットワーク良好時に2秒以内で完了しなければならない。
2. 列ソートは500ms以内に結果が反映されなければならない。
3. フィルタ適用は700ms以内に結果が反映されなければならない。

##### Requirment 18
**User Story:** PMとして、大量データ（1万件規模）でも滑らかにブラウズしたい。分析や棚卸しに必要だから。

###### Acceptance Criteria
1. ページネーションと無限スクロールのいずれかをプロジェクト設定で選べなければならない。
2. 無限スクロール時、視覚的プレースホルダ（スケルトン）が表示されなければならない。
3. サーバサイドページング時、ページ切替は1秒以内で完了しなければならない。

##### Requirment 19
**User Story:** メンバーとして、オフラインや一時切断時も作業を続けたい。編集を失わないため。

###### Acceptance Criteria
1. ネットワークが切断された場合、一覧は最後の取得結果をキャッシュ表示しなければならない。
2. インライン編集はローカルキューに蓄え、再接続時に同期しなければならない。
3. 同期失敗時、衝突解決UIを提示しなければならない。

##### Requirment 20
**User Story:** 管理者として、クライアント/サーバ双方のメトリクスを把握したい。継続改善のため。

###### Acceptance Criteria
1. レイテンシ・エラー率・件数をダッシュボードに送信しなければならない。
2. しきい値を超えた場合、警告イベントを発火しなければならない。
3. 個人情報は送信してはならない。

---

#### Epic 6
アクセシビリティ、キーボード操作、レスポンシブ対応を強化する。

##### Requirment 21
**User Story:** 支援技術ユーザーとして、スクリーンリーダーでチケットリストを快適に利用したい。情報に等しくアクセスするため。

###### Acceptance Criteria
1. テーブルは適切なARIAロール・ヘッダ関連付けを持たなければならない。
2. ソート状態はヘッダに対してアクセシブルネームで伝えられなければならない。
3. 新着やエラーはライブリージョンで通知されなければならない。

##### Requirment 22
**User Story:** パワーユーザーとして、キーボードだけで主要操作を行いたい。速度を重視するため。

###### Acceptance Criteria
1. 上下左右キーで行/セル移動できなければならない。
2. Enterで詳細を開き、Eで編集、/で検索にフォーカスが移らなければならない。
3. フォーカス可視リングは常に明瞭で、テーマ変更時も見えにくくなってはならない。

##### Requirment 23
**User Story:** メンバーとして、モバイル/タブレット/デスクトップで最適表示を見たい。場所を選ばず使うため。

###### Acceptance Criteria
1. 3つのブレークポイント（<600px、600–1024px、>1024px）でレイアウトが最適化されなければならない。
2. モバイルでは列を重要度順にスタックし、スワイプで補助列を表示できなければならない。
3. タップ領域は最小44px角を下回ってはならない。

##### Requirment 24
**User Story:** コンプライアンス担当として、色コントラストを基準値以上に保ちたい。可読性と法対応のため。

###### Acceptance Criteria
1. 主要テキストと背景のコントラスト比は4.5:1以上でなければならない。
2. バッジやボタン文言は3:1未満になってはならない。
3. コントラスト不足が検出された場合、ビルドを失敗させなければならない。

---

#### Epic 7
権限・可視性・監査を整備し、安全な共同作業を実現する。

##### Requirment 25
**User Story:** PMとして、ユーザーの権限に応じて見える列と操作を制御したい。情報漏えいを防ぐため。

###### Acceptance Criteria
1. 権限がないユーザーには担当者や機密タグ列を表示してはならない。
2. 一括操作はユーザーのロールに応じて項目が自動的に無効化されなければならない。
3. 共有ビューは閲覧権限の範囲でのみ表示されなければならない。

##### Requirment 26
**User Story:** 監査担当として、リスト上で発生した一括操作やインライン更新を追跡したい。後から説明可能にするため。

###### Acceptance Criteria
1. 一括操作実行時、対象ID・項目・旧/新値・実行者・時刻を記録しなければならない。
2. 監査ログは30日以上保持され、CSVでエクスポートできなければならない。
3. ログは一般ユーザーに表示されてはならない。

##### Requirment 27
**User Story:** セキュリティ担当として、個人情報（メール・氏名）のマスキングを制御したい。不要な露出を避けるため。

###### Acceptance Criteria
1. マスキングが有効な場合、氏名はイニシャル表記、メールは一部伏字で表示しなければならない。
2. マスキング解除は管理権限ユーザーのみに許可されなければならない。
3. エクスポート時にもマスキング設定が反映されなければならない。

##### Requirment 28
**User Story:** PMとして、プロジェクト境界を越えたデータが誤って混在しないようにしたい。誤作業を防ぐため。

###### Acceptance Criteria
1. ビューURLに含まれるプロジェクトID以外のデータは表示されてはならない。
2. 複数プロジェクト横断ビューではプロジェクト名列が必須で表示されなければならない。
3. 権限外プロジェクトのレコードは件数にも含めてはならない。

---

#### Epic 8
共有・エクスポート・パーマリンクで、チーム内外への伝達を容易にする。

##### Requirment 29
**User Story:** メンバーとして、現在の一覧をCSV/Excelにエクスポートしたい。分析や報告に使うため。

###### Acceptance Criteria
1. エクスポート時、現在のフィルタ・ソート・表示列が反映されなければならない。
2. 件数が1万件を超える場合、サーバサイドで非同期生成し、完了通知を行わなければならない。
3. 機密列は権限により除外されなければならない。

##### Requirment 30
**User Story:** PMとして、特定の保存ビューをURLで共有したい。チーム全員が同じ観点を開けるようにするため。

###### Acceptance Criteria
1. 保存ビューは安定したパーマリンクで参照できなければならない。
2. URLアクセス時、該当のフィルタ/ソート/列設定を再現しなければならない。
3. 権限外ユーザーがアクセスした場合、適切なエラーページを表示しなければならない。

##### Requirment 31
**User Story:** メンバーとして、一覧のスナップショットを画像としてコピーしたい。資料に貼り付けるため。

###### Acceptance Criteria
1. 現在の表示範囲を画像としてクリップボードにコピーできなければならない。
2. ダーク背景の資料に貼る場合に備え、背景透過の有無を選べなければならない。
3. 機密列が含まれる場合、コピー実行前に警告を表示しなければならない。

##### Requirment 32
**User Story:** サポート担当として、一覧の特定行へのダイレクトリンクを生成したい。問い合わせ対応を迅速にするため。

###### Acceptance Criteria
1. 各行には行IDを含むアンカーリンクを生成できなければならない。
2. 行リンクを開いた場合、その行がハイライトされビュー内にスクロールされなければならない。
3. 権限がない場合、リンクからも対象行は表示されてはならない。

