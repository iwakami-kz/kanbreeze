# Requirements Document

## Introduction

本システムは、アジャイル開発のスプリント管理を中心に、計画・実行・進捗可視化・レビュー・レトロスペクティブまでを一貫してサポートするプロジェクト管理サービスである。親しみ感のある落ち着いた明るい色合い（例：やわらかいブルー/ミント/サーモン系のパステル）と高い可読性を両立したUIで、メンバーの心理的負担を下げつつ、意思決定とチームの流れをなめらかにする。

## Requirments

#### Epic 1
スプリントのライフサイクル管理（作成/編集/開始/終了/複製/テンプレート）

##### Requirment 1
**User Story:** プロダクトマネージャーとして、スプリントを作成したい。計画の基準点を明確にするため。

###### Acceptance Criteria
1. ユーザーがスプリント名・開始日・終了日・ゴールを入力した場合、スプリントが下書きとして保存できる。
2. 入力が欠落・矛盾（終了日が開始日より前など）している場合、保存はできず、該当フィールドにエラーメッセージを表示する。
3. 日付・時刻はユーザーのローカルタイムゾーン（例：Asia/Tokyo）で表示・保存される。
4. 常に、スプリントゴールは200文字以内のテキスト制限を超えてはならない。

##### Requirment 2
**User Story:** スクラムマスターとして、過去の設定を流用して新しいスプリントを素早く作りたい。反復作業を減らすため。

###### Acceptance Criteria
1. ユーザーが「前スプリントから複製」を選んだ場合、期間のみ次イテレーションに調整された状態で名称・ゴール・設定が複製される。
2. 複製時に選択した要素（ゴール/作業項目/担当者/通知設定）だけをコピーできる。
3. 常に、複製元の実績データ（バーンダウン等）はコピーされない。

##### Requirment 3
**User Story:** プロダクトマネージャーとして、スプリントの開始/終了を明示的に管理したい。境界を明確にするため。

###### Acceptance Criteria
1. ユーザーが「開始」を押下した場合、ステータスが「進行中」になり、編集可能範囲が制限される（期間変更不可）。
2. 終了日を迎えた場合、自動で「終了」ステータスになり、未完了アイテムのキャリーオーバー提案が表示される。
3. 開始前のスプリントに作業時間ログを登録しようとした場合、登録できない旨をガイド表示する。

##### Requirment 4
**User Story:** スクラムマスターとして、スプリント設定をテンプレート化したい。チーム標準を保つため。

###### Acceptance Criteria
1. ユーザーが「テンプレートとして保存」を選んだ場合、名前付きテンプレートが作成され、全プロジェクト/特定プロジェクトで共有範囲を選べる。
2. テンプレート適用時、既存入力がある場合は上書き前に確認ダイアログを表示する。
3. テンプレートはバージョンを保持し、更新履歴が参照できる。

#### Epic 2
スプリント計画（スコープ選定・見積り・キャパシティ・ロック）

##### Requirment 5
**User Story:** プロダクトオーナーとして、バックログからスプリントにアイテムをドラッグ&ドロップで追加したい。計画作業を効率化するため。

###### Acceptance Criteria
1. ユーザーがアイテムをスプリント枠にドロップした場合、スプリントのスコープに追加される。
2. スプリントが進行中の場合、スコープ追加は権限者（PO/SM）のみ可能であり、履歴に記録される。
3. アイテム追加時、合計ストーリーポイントがヘッダーに即時再計算表示される。

##### Requirment 6
**User Story:** スクラムマスターとして、チームのキャパシティ（休暇/稼働率）を考慮した計画を立てたい。過負荷を防ぐため。

###### Acceptance Criteria
1. ユーザーがメンバー単位の稼働率/休暇を設定した場合、スプリント許容量（ポイント/時間）が自動算出される。
2. 合計見積りが許容量を超えた場合、視覚的に警告（やわらかい注意色）を表示し、超過量を明示する。
3. 許容量の基準（稼働時間/ポイント換算）はプロジェクト設定で変更可能である。

##### Requirment 7
**User Story:** 開発者として、見積りをプランニングポーカーで合わせたい。チーム合意を得るため。

###### Acceptance Criteria
1. ユーザーが見積りセッションを開始した場合、参加者のカードが伏せ状態で入力でき、全員提出後に同時公開される。
2. 乖離が閾値を超える場合、再見積りの提案とコメント入力欄が表示される。
3. 決定したポイントはアイテムに反映され、履歴に記録される。

##### Requirment 8
**User Story:** プロダクトオーナーとして、計画確定後はスコープ変更を制限したい。予期せぬスコープクリープを抑えるため。

###### Acceptance Criteria
1. ユーザーが「スコープロック」を有効にした場合、追加/削除は事前承認フロー（2段階）を通過しなければならない。
2. ロック中の変更が承認された場合、バーンチャートに「スコープ変動」イベントが記録される。
3. 常に、ロック状態はスプリントヘッダーに視認できるアイコンで示される。

#### Epic 3
実行と可視化（ボード・WIP制限・スイムレーン・スタンドアップ）

##### Requirment 9
**User Story:** 開発者として、カンバン/スクラムボードで状態を直感的に更新したい。手戻りを減らすため。

###### Acceptance Criteria
1. ユーザーがカードを列間でドラッグした場合、状態が更新され、必要なチェック（レビュー必須等）が満たされない場合は移動できない。
2. 列ごとにWIP上限を設定でき、上限超過時は投入がブロックされるか、例外承認が必要となる。
3. ボードはレスポンシブで、モバイルでは列が水平スクロールで操作できる。

##### Requirment 10
**User Story:** スクラムマスターとして、優先度や担当でスイムレーンを切り替えたい。ボトルネックを見つけるため。

###### Acceptance Criteria
1. ユーザーがスイムレーン条件を選択した場合、ボードが即時再配置される。
2. 常に、並び替え/フィルタ条件はURLに反映され、共有リンクで同じビューを再現できる。
3. フィルタは複数選択に対応し、選択数をヘッダーにバッジ表示する。

##### Requirment 11
**User Story:** チームメンバーとして、デイリースタンドアップの要点（昨日/今日/ブロッカー）を素早く記録したい。情報の散逸を防ぐため。

###### Acceptance Criteria
1. 毎営業日の指定時刻になった場合、スタンドアップ入力モーダルが通知から開ける。
2. 入力内容はスプリント日誌に集約表示され、検索/エクスポート可能である。
3. ブロッカーを登録した場合、関係者に自動メンション通知が送信される。

##### Requirment 12
**User Story:** QAとして、レビュー/テスト待ちのカードをひと目で把握したい。滞留を解消するため。

###### Acceptance Criteria
1. 状態が「レビュー待ち」「QA待ち」のカード数・平均滞留時間が列ヘッダーに表示される。
2. 滞留時間がしきい値を超えた場合、カードにソフトハイライトが付与される。
3. レビュー依頼を受けた担当者には、未対応のまま24時間経過した場合リマインドが送信される。

#### Epic 4
メトリクスと予測（バーンダウン/バーンアップ/ベロシティ/予実）

##### Requirment 13
**User Story:** プロダクトオーナーとして、バーンダウンチャートで残作業の推移を見たい。リスク早期発見のため。

###### Acceptance Criteria
1. スプリント開始時に理想線が自動描画され、毎日指定時刻に実績が更新される。
2. スコープ変動が発生した場合、チャート上にイベントマーカーが表示され、差分が注釈される。
3. 時間見積りとポイント見積りの表示を切り替え可能である。

##### Requirment 14
**User Story:** スクラムマスターとして、ベロシティの推移から完了見込みを予測したい。コミットメント調整のため。

###### Acceptance Criteria
1. 直近Nスプリントのベロシティ実績から信頼区間つき予測が生成される。
2. 予測区間が目標完了を下回る場合、警告と範囲内に収めるためのシミュレーション（アイテム削減/人員増強）が提示される。
3. 外れ値扱いの条件（休暇集中等）を指定して計算から除外できる。

##### Requirment 15
**User Story:** ステークホルダーとして、デイリーの進捗サマリを簡潔に受け取りたい。状況共有の手間を減らすため。

###### Acceptance Criteria
1. 毎日19:00になった場合、進捗サマリ（完了ポイント・残ポイント・リスク）がサブスクライブ先に送信される。
2. サマリはメール/チャット連携の両方に対応し、開封トラッキングを保持する。
3. 常に、通知の配色は落ち着いた明るいトーンで要点を強調し、WCAGコントラスト比を満たす。

##### Requirment 16
**User Story:** 経営層として、予実管理（計画 vs 実績）を俯瞰したい。意思決定に資するため。

###### Acceptance Criteria
1. スプリントごとの計画/実績ポイント・時間・スコープ変動が表とチャートで可視化される。
2. セグメント（コンポーネント/担当/ラベル）別にドリルダウンでき、CSVエクスポートが可能である。
3. 常に、集計基準（完了定義DoD/部分完了の扱い）は画面上に明示される。

#### Epic 5
スプリント完了・レビュー（デモ準備・受け入れ・キャリーオーバー）

##### Requirment 17
**User Story:** プロダクトオーナーとして、レビュー対象を自動抽出したい。抜け漏れをなくすため。

###### Acceptance Criteria
1. ステータスが「完了」かつDoDを満たしたアイテムがレビューリストに自動集約される。
2. デモ順序はドラッグで並べ替えでき、アジェンダとして出力できる（PDF/リンク）。
3. 常に、開発・QA・PO承認の三者確認が揃ったもののみ「受け入れ済み」になる。

##### Requirment 18
**User Story:** スクラムマスターとして、未完了のアイテムを次スプリントへ適切にキャリーオーバーしたい。再計画を円滑にするため。

###### Acceptance Criteria
1. 終了時に未完了アイテムが一覧化され、次スプリント候補への一括移動ができる。
2. キャリーオーバー時、残見積りを自動再計算し、根拠コメントの入力が必須となる。
3. キャリー履歴はアイテムに残り、累計回数でフィルタ可能である。

##### Requirment 19
**User Story:** ステークホルダーとして、スプリントレビューの決定事項を共有したい。合意の透明性のため。

###### Acceptance Criteria
1. レビューの結論・アクションアイテム・責任者・期日を記録し、関係者に配信できる。
2. 配信後に修正が入った場合、変更点のみをハイライトして再配信できる。
3. 常に、配布資料はブランドカラーに基づく読みやすいテンプレートで生成される。

##### Requirment 20
**User Story:** プロダクトマネージャーとして、スプリントゴールの達成度を定量・定性で評価したい。振り返りの軸を整理するため。

###### Acceptance Criteria
1. ゴールに紐づくKPI進捗（%）と証跡（リンク/添付）が登録・表示できる。
2. 達成度がしきい値を下回る場合、レトロスペクティブの議題候補に自動追加される。
3. 常に、達成判定の基準説明がゴール詳細に表示される。

#### Epic 6
レトロスペクティブと学習（ふりかえり・KPT/5Whys・アクション追跡）

##### Requirment 21
**User Story:** スクラムマスターとして、KPT形式でふりかえりを実施したい。継続的改善のため。

###### Acceptance Criteria
1. 参加者が匿名/記名を選べ、K/Keeps・P/Problems・T/Trysを同時編集できる。
2. 類似カードは自動クラスタリング提案がされ、手動で統合できる。
3. ふりかえり結果は次スプリントの「アクションアイテム」として引き継げる。

##### Requirment 22
**User Story:** スクラムマスターとして、原因分析を5Whysで掘り下げたい。再発防止のため。

###### Acceptance Criteria
1. 問題カードから5Whysツリーを作成でき、各Whyに根拠リンクを添付できる。
2. ルート原因に到達した場合、是正アクションのテンプレートが提示される。
3. アクションにはオーナー/期日/期待効果を必須化し、進捗ステータスを追跡できる。

##### Requirment 23
**User Story:** チームとして、レトロの合意事項を次スプリントの準備に自動反映したい。抜けを防ぐため。

###### Acceptance Criteria
1. レトロで決定したWIP上限や定例の改善項目が次スプリント設定に提案される。
2. 提案は「一括適用/部分適用/破棄」を選べ、適用結果は履歴に残る。
3. 常に、適用前後の差分が比較表示できる。

##### Requirment 24
**User Story:** ステークホルダーとして、改善の効果を可視化したい。継続投資判断のため。

###### Acceptance Criteria
1. 改善アクションとメトリクス（リードタイム/欠陥率等）の相関がダッシュボードで表示される。
2. 指定期間で改善前後を比較し、統計的有意性の簡易指標を提示する。
3. ダッシュボードはCSV/画像としてエクスポートできる。

#### Epic 7
コラボレーションと通知（リマインド・メンション・外部連携）

##### Requirment 25
**User Story:** チームメンバーとして、重要イベントのリマインドを受け取りたい。うっかりを防ぐため。

###### Acceptance Criteria
1. スプリント開始前日・初日朝・終了前日・終了日朝に自動リマインドが配信される。
2. リマインドは個人/チャンネル宛てを選択でき、配信先ごとのサイレンス時間帯を設定できる。
3. 常に、配信テンプレートは落ち着いた明るい配色で可読性が確保される。

##### Requirment 26
**User Story:** メンバーとして、コメントでメンション通知を使いたい。意思疎通を速めるため。

###### Acceptance Criteria
1. 「@ユーザー」「#ラベル」で対象に通知でき、未読数がアバターに表示される。
2. メンションを受けた場合、アプリ内/メール/チャットの通知チャネルを選べる。
3. 既読/未読の状態はスレッド単位で管理される。

##### Requirment 27
**User Story:** プロダクトマネージャーとして、チャット/課題管理/CIと連携したい。情報を一元化するため。

###### Acceptance Criteria
1. 外部ツール（例：Slack/Teams/GitHub/Jira）とOAuth連携ができる。
2. 連携後、スプリントイベント（開始/終了/スコープ変動/ビルド失敗）を自動投稿できる。
3. 常に、連携はプロジェクト単位でオン/オフ制御できる。

##### Requirment 28
**User Story:** ステークホルダーとして、閲覧専用リンクで状況を見たい。アカウント作成の手間を省くため。

###### Acceptance Criteria
1. ビューワー専用URLを発行でき、期限とパスワードを設定できる。
2. 閲覧権限では機密情報（担当者メール等）がマスク表示される。
3. アクセスログが記録され、無効化は即時反映される。

#### Epic 8
UX/デザインシステム（配色・アクセシビリティ・レスポンシブ・テーマ）

##### Requirment 29
**User Story:** デザイナーとして、親しみ感のある落ち着いた明るい色合いを全画面で統一したい。体験を一貫させるため。

###### Acceptance Criteria
1. デザインシステムに色トークン（`--color-primary`, `--color-accent`, `--color-surface`, `--color-attention-soft` 等）を定義し、全UIがトークン参照で実装される。
2. 主要テキストと背景のコントラストはWCAG AA（通常文 4.5:1 以上）を満たす。
3. 状態色（成功/警告/エラー）は原色ではなくパステルトーンを基調にし、ホバー/アクティブ/フォーカスの段階差がある。

##### Requirment 30
**User Story:** ユーザーとして、ライト/ダークと高コントラストを切り替えたい。利用環境に合わせるため。

###### Acceptance Criteria
1. システム設定に「ライト」「ダーク」「高コントラスト」を用意し、ユーザー/ブラウザの設定を初期値として検出する。
2. テーマ切替は瞬時に適用され、アニメーションは100–200msの落ち着いたトランジションで実装される。
3. 常に、色覚多様性（赤緑等）に配慮した配色検証がビルド時に自動チェックされる。

##### Requirment 31
**User Story:** プロダクトマネージャーとして、主要画面をモバイルでも快適に使いたい。現場からの更新を容易にするため。

###### Acceptance Criteria
1. ボード/詳細/レポート画面はモバイル幅で主要操作が1–2タップで完了できる。
2. タップ領域は最小44px角以上を確保し、主要CTAは画面下部に固定される。
3. グラフは縦スクロールに最適化され、ツールチップは長押しで表示できる。

##### Requirment 32
**User Story:** QAとして、インタラクションのフォーカス可視性を確保したい。キーボード操作を支援するため。

###### Acceptance Criteria
1. すべての操作要素にフォーカスリングが表示され、コントラストが背景比3:1以上である。
2. キーボードのみで主要フロー（スプリント作成→計画→実行→レビュー）が完了できる。
3. フォーカス順はDOM順と一致し、スキップリンクが提供される。

#### Epic 9
権限・監査・設定（ロール/履歴/監査ログ/セキュリティ）

##### Requirment 33
**User Story:** 管理者として、ロール別に操作権限を制御したい。ガバナンスを担保するため。

###### Acceptance Criteria
1. 既定ロール（管理者/PO/SM/メンバー/閲覧者）とカスタムロールを設定できる。
2. 機能ごと（スコープ変更/終了操作/レポート閲覧等）に許可/不許可を細粒度で設定できる。
3. 許可されていない操作を試みた場合、理由と申請フロー案内を表示する。

##### Requirment 34
**User Story:** 監査担当として、重要操作の履歴を追跡したい。コンプライアンスのため。

###### Acceptance Criteria
1. スプリント状態変更・スコープ変更・権限更新などが監査ログに記録される（操作者/日時/差分）。
2. 監査ログはフィルタ・エクスポート可能で、保持期間を設定できる。
3. 常に、個人情報は最小限でマスキング保存される。

##### Requirment 35
**User Story:** 管理者として、プロジェクト標準（期間・開始曜日・通知時刻）を設定したい。チーム運用を統一するため。

###### Acceptance Criteria
1. 既定スプリント期間（1/2/3週間など）と開始曜日を設定できる。
2. 標準の通知時刻（開始前日19:00等）をプロジェクト単位で定義できる。
3. 設定変更は次スプリントから適用され、既存スプリントには影響しない。

##### Requirment 36
**User Story:** セキュリティ担当として、外部共有とデータ保護を両立したい。情報漏えいを防ぐため。

###### Acceptance Criteria
1. 外部共有リンクには有効期限/ダウンロード禁止/透かしのオプションを付与できる。
2. 重要レポートにはロールに応じたマスキングが適用される。
3. IP制限やSSO（SAML/OIDC）と併用できる。

#### Epic 10
カレンダー・時間管理（休日考慮・iCal連携・タイムゾーン）

##### Requirment 37
**User Story:** スクラムマスターとして、国/地域の祝日とチーム休暇を考慮してスプリント期間を設定したい。現実的な計画のため。

###### Acceptance Criteria
1. プロジェクト地域の祝日カレンダーを参照し、稼働日数を自動計算する。
2. メンバーの個別休暇を反映し、キャパシティに自動反映される。
3. 稼働日が少なすぎる場合、警告と代替案（開始日の調整）が提示される。

##### Requirment 38
**User Story:** メンバーとして、個人カレンダーとスプリントイベントを連携したい。予定の重複を避けるため。

###### Acceptance Criteria
1. iCal/Google/Outlookにスプリント開始/終了/レビュー/レトロの予定を購読配信できる。
2. 二重登録防止のため、イベントIDで重複を検出し更新/削除を同期できる。
3. タイムゾーン差異がある場合、表示時にユーザーのローカル時間へ自動変換される。

##### Requirment 39
**User Story:** プロダクトオーナーとして、リリースカデンスとスプリントを同期したい。外部コミットメントを守るため。

###### Acceptance Criteria
1. リリース日程を登録すると、スプリント計画時に衝突/整合が可視化される。
2. 衝突がある場合、スプリント期間調整やスコープ圧縮のシミュレーションが提示される。
3. リリースノート生成にスプリント完了項目が自動で取り込まれる。

